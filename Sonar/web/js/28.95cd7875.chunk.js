webpackJsonp([28],{1653:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"UnconnectedNotifications",function(){return g});var i=n(0),c=n.n(i),u=n(22),l=n.n(u),s=n(8),f=(n.n(s),n(1928)),p=n(1930),h=n(2),y=n(1785),m=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),d=c.a.createElement(f.a,null),b=c.a.createElement("hr",{className:"account-separator"}),v=c.a.createElement(p.a,null),j=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),m(t,[{key:"componentDidMount",value:function(){this.props.fetchNotifications()}},{key:"render",value:function(){return c.a.createElement("div",{className:"account-body account-container"},c.a.createElement(l.a,{title:n.i(h.translate)("my_account.notifications")}),c.a.createElement("p",{className:"big-spacer-bottom"},n.i(h.translate)("notification.dispatcher.information")),d,b,v)}}]),t}(c.a.PureComponent),E={fetchNotifications:y.a};t.default=n.i(s.connect)(null,E)(j);var g=j},1785:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return u});var o=n(1913),r=n(86),a=n(672),i=function(){return function(e){var t=function(t){var o=t.notifications.filter(function(e){return e.organization}).map(function(e){return e.organization});e(n.i(r.b)(o)).then(function(){e(n.i(a.h)(t.notifications,t.channels,t.globalTypes,t.perProjectTypes))})};return o.a().then(t,n.i(r.a)(e))}},c=function(e){return function(t){return o.b(e.channel,e.type,e.project).then(function(){return t(n.i(a.i)(e))},n.i(r.a)(t))}},u=function(e){return function(t){return o.c(e.channel,e.type,e.project).then(function(){return t(n.i(a.j)(e))},n.i(r.a)(t))}}},1891:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=n(0),c=n.n(i),u=n(215),l=n(2),s=(n(672),function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}()),f=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"isEnabled",value:function(e,t){return!!this.props.notifications.find(function(n){return n.type===e&&n.channel===t})}},{key:"handleCheck",value:function(e,t,n){n?this.props.onAdd({type:e,channel:t}):this.props.onRemove({type:e,channel:t})}},{key:"render",value:function(){var e=this,t=this.props,o=t.channels,r=t.checkboxId,a=t.types;return c.a.createElement("tbody",null,a.map(function(t){return c.a.createElement("tr",{key:t},c.a.createElement("td",null,n.i(l.translate)("notification.dispatcher",t)),o.map(function(n){return c.a.createElement("td",{key:n,className:"text-center"},c.a.createElement(u.a,{checked:e.isEnabled(t,n),id:r(t,n),onCheck:function(o){return e.handleCheck(t,n,o)}}))}))}))}}]),t}(c.a.PureComponent);t.a=f},1913:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"c",function(){return i});var o=n(20),r=function(){return n.i(o.getJSON)("/api/notifications/list")},a=function(e,t,r){var a={channel:e,type:t};return r&&Object.assign(a,{project:r}),n.i(o.post)("/api/notifications/add",a)},i=function(e,t,r){var a={channel:e,type:t};return r&&Object.assign(a,{project:r}),n.i(o.post)("/api/notifications/remove",a)}},1928:function(e,t,n){"use strict";function o(e){return a.a.createElement("section",null,a.a.createElement("h2",{className:"spacer-bottom"},n.i(u.translate)("my_profile.overall_notifications.title")),a.a.createElement("table",{className:"form"},a.a.createElement("thead",null,a.a.createElement("tr",null,f,e.channels.map(function(e){return a.a.createElement("th",{key:e,className:"text-center"},a.a.createElement("h4",null,n.i(u.translate)("notification.channel",e)))}))),a.a.createElement(c.a,{notifications:e.notifications,channels:e.channels,types:e.types,checkboxId:function(e,t){return"global-notification-"+e+"-"+t},onAdd:e.addNotification,onRemove:e.removeNotification})))}var r=n(0),a=n.n(r),i=n(8),c=(n.n(i),n(1891)),u=n(2),l=n(7),s=n(1785),f=a.a.createElement("th",null),p=function(e){return{notifications:n.i(l.getGlobalNotifications)(e),channels:n.i(l.getNotificationChannels)(e),types:n.i(l.getNotificationGlobalTypes)(e)}},h={addNotification:s.b,removeNotification:s.c};t.a=n.i(i.connect)(p,h)(o)},1929:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=n(0),c=n.n(i),u=n(8),l=(n.n(u),n(9)),s=n(1891),f=n(329),p=n(2),h=n(7),y=n(1785),m=n(48),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),b=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),d(t,[{key:"handleAddNotification",value:function(e){var t=e.channel,n=e.type;this.props.addNotification({channel:t,type:n,project:this.props.project.key,projectName:this.props.project.name,organization:this.props.project.organization})}},{key:"handleRemoveNotification",value:function(e){var t=e.channel,n=e.type;this.props.removeNotification({channel:t,type:n,project:this.props.project.key})}},{key:"render",value:function(){var e=this,t=this.props,o=t.project,r=t.channels;return c.a.createElement("table",{key:o.key,className:"form big-spacer-bottom"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,c.a.createElement("span",{className:"text-normal"},c.a.createElement(f.a,{organizationKey:o.organization})),c.a.createElement("h4",{className:"display-inline-block"},c.a.createElement(l.Link,{to:n.i(m.a)(o.key)},o.name))),r.map(function(e){return c.a.createElement("th",{key:e,className:"text-center"},c.a.createElement("h4",null,n.i(p.translate)("notification.channel",e)))}))),c.a.createElement(s.a,{notifications:this.props.notifications,channels:this.props.channels,types:this.props.types,checkboxId:function(e,t){return"project-notification-"+o.key+"-"+e+"-"+t},onAdd:function(t){return e.handleAddNotification(t)},onRemove:function(t){return e.handleRemoveNotification(t)}}))}}]),t}(c.a.PureComponent),v=function(e,t){return{notifications:n.i(h.getProjectNotifications)(e,t.project.key),channels:n.i(h.getNotificationChannels)(e),types:n.i(h.getNotificationPerProjectTypes)(e)}},j={addNotification:y.b,removeNotification:y.c};t.a=n.i(u.connect)(v,j)(b)},1930:function(e,t,n){"use strict";function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c=n(0),u=n.n(c),l=n(56),s=n.n(l),f=n(8),p=(n.n(f),n(4)),h=(n.n(p),n(1929)),y=n(329),m=n(2),d=n(40),b=n(7),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),j=u.a.createElement("span",{className:"text-middle spacer-right"},"Set notifications for:"),E=function(e){function t(){var e,i,c,l;r(this,t);for(var s=arguments.length,f=Array(s),p=0;p<s;p++)f[p]=arguments[p];return i=c=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(f))),c.state={addedProjects:[]},c.loadOptions=function(e,t){if(e.length<2)return void t(null,{options:[]});n.i(d.w)(e).then(function(e){var t=e.results.find(function(e){return"TRK"===e.q});return t?t.items:[]}).then(function(e){return e.map(function(e){return{value:e.key,label:e.name,organization:e.organization}})}).then(function(e){t(null,{options:e})})},c.handleAddProject=function(e){var t={key:e.value,name:e.label,organization:e.organization};c.setState({addedProjects:[].concat(o(c.state.addedProjects),[t])})},c.renderOption=function(e){return u.a.createElement("span",null,u.a.createElement(y.a,{organizationKey:e.organization,link:!1}),u.a.createElement("strong",null,e.label))},l=i,a(c,l)}return i(t,e),v(t,[{key:"componentWillReceiveProps",value:function(e){var t=n.i(p.differenceBy)(this.state.addedProjects,e.projects,function(e){return e.key});t.length!==this.state.addedProjects&&this.setState({addedProjects:t})}},{key:"render",value:function(){var e=[].concat(o(this.props.projects),o(this.state.addedProjects));return u.a.createElement("section",null,u.a.createElement("h2",{className:"spacer-bottom"},n.i(m.translate)("my_profile.per_project_notifications.title")),0===e.length&&u.a.createElement("div",{className:"note"},n.i(m.translate)("my_account.no_project_notifications")),e.map(function(e){return u.a.createElement(h.a,{key:e.key,project:e})}),u.a.createElement("div",{className:"spacer-top panel bg-muted"},j,u.a.createElement(s.a.Async,{autoload:!1,cache:!1,name:"new_project",style:{width:"300px"},loadOptions:this.loadOptions,minimumInput:2,optionRenderer:this.renderOption,onChange:this.handleAddProject,placeholder:"Search Project"})))}}]),t}(u.a.PureComponent),g=function(e){return{projects:n.i(b.getProjectsWithNotifications)(e)}};t.a=n.i(f.connect)(g)(E)}});
//# sourceMappingURL=28.95cd7875.chunk.js.map