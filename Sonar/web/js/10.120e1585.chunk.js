webpackJsonp([10],{1669:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n.n(o),l=n(22),u=n.n(l),c=n(8),d=(n.n(c),n(1991)),m=n(7),p=n(2),h=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),f=function(e){function t(){return a(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),h(t,[{key:"componentDidMount",value:function(){n.i(d.a)(this.refs.container,this.props.component)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(u.a,{title:n.i(p.translate)("custom_measures.page")}),r.a.createElement("div",{ref:"container"}))}}]),t}(r.a.PureComponent),v=function(e,t){return{component:n.i(m.getComponent)(e,t.location.query.id)}};t.default=n.i(c.connect)(v)(f)},1775:function(e,t,n){"use strict";var a=n(4),s=(n.n(a),n(17)),i=n.n(s);t.a=i.a.Model.extend({idAttribute:"id",urlRoot:function(){return window.baseUrl+"/api/metrics"},sync:function(e,t,s){var o=s||{};return"create"===e&&n.i(a.defaults)(o,{url:this.urlRoot()+"/create",type:"POST",data:n.i(a.pick)(t.toJSON(),"key","name","description","domain","type")}),"update"===e&&n.i(a.defaults)(o,{url:this.urlRoot()+"/update",type:"POST",data:n.i(a.pick)(t.toJSON(),"id","key","name","description","domain","type")}),"delete"===e&&n.i(a.defaults)(o,{url:this.urlRoot()+"/delete",type:"POST",data:{ids:this.id}}),i.a.ajax(o)}})},1799:function(e,t,n){"use strict";var a=n(17),s=n.n(a),i=n(1775);t.a=s.a.Collection.extend({model:i.a,url:function(){return window.baseUrl+"/api/metrics/search"},parse:function(e){return this.total=e.total,this.p=e.p,this.ps=e.ps,e.metrics},fetch:function(e){var t=Object.assign({data:{}},e);return this.q=t.data.q,t.data.isCustom=!0,s.a.Collection.prototype.fetch.call(this,t)},fetchMore:function(){var e=this.p+1;return this.fetch({add:!0,remove:!1,data:{p:e,ps:this.ps,q:this.q}})},refresh:function(){return this.fetch({reset:!0,data:{q:this.q}})},hasMore:function(){return this.total>this.p*this.ps}})},1896:function(e,t,n){"use strict";var a=n(4),s=(n.n(a),n(17)),i=n.n(s);t.a=i.a.Model.extend({idAttribute:"id",urlRoot:function(){return window.baseUrl+"/api/custom_measures"},sync:function(e,t,s){var o=s||{};return"create"===e&&n.i(a.defaults)(o,{url:this.urlRoot()+"/create",type:"POST",data:n.i(a.pick)(t.toJSON(),"metricId","value","description","projectId")}),"update"===e&&n.i(a.defaults)(o,{url:this.urlRoot()+"/update",type:"POST",data:n.i(a.pick)(t.toJSON(),"id","value","description")}),"delete"===e&&n.i(a.defaults)(o,{url:this.urlRoot()+"/delete",type:"POST",data:{id:this.id}}),i.a.ajax(o)}})},1897:function(e,t,n){"use strict";var a=n(30),s=n(1799),i=n(2269),o=n.n(i);t.a=a.a.extend({template:o.a,initialize:function(){this.metrics=new s.a,this.listenTo(this.metrics,"reset",this.render),this.metrics.fetch({reset:!0})},onRender:function(){a.a.prototype.onRender.apply(this,arguments),this.$('[data-toggle="tooltip"]').tooltip({container:"body",placement:"bottom"}),this.$("#create-custom-measure-metric").select2({width:"250px",minimumResultsForSearch:20})},onDestroy:function(){a.a.prototype.onDestroy.apply(this,arguments),this.$('[data-toggle="tooltip"]').tooltip("destroy")},onFormSubmit:function(){a.a.prototype.onFormSubmit.apply(this,arguments),this.sendRequest()},getAvailableMetrics:function(){var e=this.collection.getTakenMetrics();return this.metrics.toJSON().filter(function(t){return-1===e.indexOf(t.id)})},serializeData:function(){var e=this.getAvailableMetrics(),t=!this.model;return Object.assign({},a.a.prototype.serializeData.apply(this,arguments),{metrics:e,canCreateMetric:!t||e.length>0})}})},1987:function(e,t,n){"use strict";var a=n(1896),s=n(1897);t.a=s.a.extend({sendRequest:function(){var e=this,t=new a.a({metricId:this.$("#create-custom-measure-metric").val(),value:this.$("#create-custom-measure-value").val(),description:this.$("#create-custom-measure-description").val(),projectId:this.options.projectId});return this.disableForm(),t.save(null,{statusCode:{400:null}}).done(function(){e.collection.refresh(),e.destroy()}).fail(function(t){e.enableForm(),e.showErrors(t.responseJSON.errors,t.responseJSON.warnings)})}})},1988:function(e,t,n){"use strict";var a=n(4),s=(n.n(a),n(17)),i=n.n(s),o=n(1896);t.a=i.a.Collection.extend({model:o.a,initialize:function(e){this.projectId=e.projectId},url:function(){return window.baseUrl+"/api/custom_measures/search"},parse:function(e){return this.total=e.total,this.p=e.p,this.ps=e.ps,e.customMeasures},fetch:function(e){var t=Object.assign({data:{}},e);return this.q=t.data.q,t.data.projectId=this.projectId,i.a.Collection.prototype.fetch.call(this,t)},fetchMore:function(){var e=this.p+1;return this.fetch({add:!0,remove:!1,data:{p:e,ps:this.ps,q:this.q}})},refresh:function(){return this.fetch({reset:!0,data:{q:this.q}})},hasMore:function(){return this.total>this.p*this.ps},getTakenMetrics:function(){var e=this.map(function(e){return e.get("metric").id});return n.i(a.uniq)(e)}})},1989:function(e,t,n){"use strict";var a=n(30),s=n(2268),i=n.n(s);t.a=a.a.extend({template:i.a,onFormSubmit:function(){a.a.prototype.onFormSubmit.apply(this,arguments),this.sendRequest()},sendRequest:function(){var e=this,t=this.model.collection;return this.model.destroy({wait:!0,statusCode:{400:null}}).done(function(){t.refresh(),e.destroy()}).fail(function(t){e.showErrors(t.responseJSON.errors,t.responseJSON.warnings)})}})},1990:function(e,t,n){"use strict";var a=n(13),s=n.n(a),i=n(1987),o=n(2270),r=n.n(o);t.a=s.a.ItemView.extend({template:r.a,events:{"click #custom-measures-create":"onCreateClick"},onCreateClick:function(e){e.preventDefault(),this.createCustomMeasure()},createCustomMeasure:function(){new i.a({collection:this.collection,projectId:this.options.projectId}).render()}})},1991:function(e,t,n){"use strict";var a=n(13),s=n.n(a),i=n(1992),o=n(1988),r=n(1990),l=n(1995),u=n(1993),c=new s.a.Application,d=function(e,t){this.layout=new i.a({el:e}),this.layout.render(),this.customMeasures=new o.a({projectId:t.id}),this.headerView=new r.a({collection:this.customMeasures,projectId:t.id}),this.layout.headerRegion.show(this.headerView),this.listView=new l.a({collection:this.customMeasures}),this.layout.listRegion.show(this.listView),this.listFooterView=new u.a({collection:this.customMeasures}),this.layout.listFooterRegion.show(this.listFooterView),this.customMeasures.fetch()};c.on("start",function(e){d.call(c,e.el,e.component)}),t.a=function(e,t){c.start({el:e,component:t})}},1992:function(e,t,n){"use strict";var a=n(13),s=n.n(a),i=n(2271),o=n.n(i);t.a=s.a.LayoutView.extend({template:o.a,regions:{headerRegion:"#custom-measures-header",listRegion:"#custom-measures-list",listFooterRegion:"#custom-measures-list-footer"}})},1993:function(e,t,n){"use strict";var a=n(13),s=n.n(a),i=n(2272),o=n.n(i);t.a=s.a.ItemView.extend({template:o.a,collectionEvents:{all:"render"},events:{"click #custom-measures-fetch-more":"onMoreClick"},onMoreClick:function(e){e.preventDefault(),this.fetchMore()},fetchMore:function(){this.collection.fetchMore()},serializeData:function(){return Object.assign({},s.a.ItemView.prototype.serializeData.apply(this,arguments),{total:this.collection.total,count:this.collection.length,more:this.collection.hasMore()})}})},1994:function(e,t,n){"use strict";var a=n(13),s=n.n(a),i=n(1996),o=n(1989),r=n(2273),l=n.n(r);t.a=s.a.ItemView.extend({tagName:"tr",template:l.a,events:{"click .js-custom-measure-update":"onUpdateClick","click .js-custom-measure-delete":"onDeleteClick"},onRender:function(){this.$el.attr("data-id",this.model.id),this.$('[data-toggle="tooltip"]').tooltip({container:"body",placement:"bottom"})},onDestroy:function(){this.$('[data-toggle="tooltip"]').tooltip("destroy")},onUpdateClick:function(e){e.preventDefault(),this.updateCustomMeasure()},onDeleteClick:function(e){e.preventDefault(),this.deleteCustomMeasure()},updateCustomMeasure:function(){new i.a({model:this.model,collection:this.model.collection}).render()},deleteCustomMeasure:function(){new o.a({model:this.model}).render()}})},1995:function(e,t,n){"use strict";var a=n(13),s=n.n(a),i=n(1994),o=n(2274),r=n.n(o);t.a=s.a.CompositeView.extend({template:r.a,childView:i.a,childViewContainer:"tbody"})},1996:function(e,t,n){"use strict";var a=n(1897);t.a=a.a.extend({sendRequest:function(){var e=this;return this.model.set({value:this.$("#create-custom-measure-value").val(),description:this.$("#create-custom-measure-description").val()}),this.disableForm(),this.model.save(null,{statusCode:{400:null}}).done(function(){e.collection.refresh(),e.destroy()}).fail(function(t){e.enableForm(),e.showErrors(t.responseJSON.errors,t.responseJSON.warnings)})}})},2268:function(e,t,n){var a=n(5);e.exports=(a.default||a).template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,a){var s,i=this.lambda;return'<form id="delete-custom-measure-form">\n  <div class="modal-head">\n    <h2>Delete Custom Measure</h2>\n  </div>\n  <div class="modal-body">\n    <div class="js-modal-messages"></div>\n    Are you sure you want to delete custom measure "'+(0,this.escapeExpression)(i(null!=(s=null!=e?e.metric:e)?s.name:s,e))+'"?\n  </div>\n  <div class="modal-foot">\n    <button id="delete-custom-measure-submit" class="button-red">Delete</button>\n    <a href="#" class="js-modal-close" id="delete-custom-measure-cancel">Cancel</a>\n  </div>\n</form>\n'},useData:!0})},2269:function(e,t,n){function a(e){return e&&(e.__esModule?e.default:e)}var s=n(5);e.exports=(s.default||s).template({1:function(e,t,n,a){return"Update"},3:function(e,t,n,a){return"Create"},5:function(e,t,n,a,s){var i,o="";return i=t.if.call(e,null!=e?e.canCreateMetric:e,{name:"if",hash:{},fn:this.program(6,a,s),inverse:this.program(10,a,s),data:a}),null!=i&&(o+=i),o},6:function(e,t,n,a,s){var i,o='        <div class="modal-field">\n          <label for="create-custom-measure-metric">Metric<em class="mandatory">*</em></label>\n          <select id="create-custom-measure-metric" name="metric" required>\n';return i=t.each.call(e,null!=e?e.metrics:e,{name:"each",hash:{},fn:this.program(7,a,s),inverse:this.noop,data:a}),null!=i&&(o+=i),o+"          </select>\n        </div>\n"},7:function(e,t,s,i,o){var r,l=this.lambda,u=this.escapeExpression,c='              <option value="'+u(l(null!=e?e.id:e,e))+'" ';return r=a(n(12)).call(e,null!=e?e.id:e,null!=(r=null!=o[1]?o[1].metric:o[1])?r.id:r,{name:"eq",hash:{},fn:this.program(8,i,o),inverse:this.noop,data:i}),null!=r&&(c+=r),c+">"+u(l(null!=e?e.name:e,e))+"</option>\n"},8:function(e,t,n,a){return"selected"},10:function(e,t,s,i){return'        <div class="alert alert-warning">'+(0,this.escapeExpression)(a(n(1)).call(e,"custom_measures.all_metrics_taken",{name:"t",hash:{},data:i}))+"</div>\n"},12:function(e,t,n,a){return"disabled"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,a,s){var i,o=this.lambda,r=this.escapeExpression,l='<form id="create-custom-measure-form" autocomplete="off">\n  <div class="modal-head">\n    <h2>';return i=t.if.call(e,null!=e?e.id:e,{name:"if",hash:{},fn:this.program(1,a,s),inverse:this.program(3,a,s),data:a}),null!=i&&(l+=i),l+=' Custom Measure</h2>\n  </div>\n  <div class="modal-body">\n    <div class="js-modal-messages"></div>\n\n',i=t.unless.call(e,null!=e?e.id:e,{name:"unless",hash:{},fn:this.program(5,a,s),inverse:this.noop,data:a}),null!=i&&(l+=i),l+='\n    <div class="modal-field">\n      <label for="create-custom-measure-value">Value<em class="mandatory">*</em></label>\n      <input id="create-custom-measure-value" name="value" type="text" maxlength="200" required value="'+r(o(null!=e?e.value:e,e))+'">\n    </div>\n\n    <div class="modal-field">\n      <label for="create-custom-measure-description">Description</label>\n      <textarea id="create-custom-measure-description" name="description">'+r(o(null!=e?e.description:e,e))+'</textarea>\n    </div>\n  </div>\n  <div class="modal-foot">\n    <button id="create-custom-measure-submit" ',i=t.unless.call(e,null!=e?e.canCreateMetric:e,{name:"unless",hash:{},fn:this.program(12,a,s),inverse:this.noop,data:a}),null!=i&&(l+=i),l+=">\n      ",i=t.if.call(e,null!=e?e.id:e,{name:"if",hash:{},fn:this.program(1,a,s),inverse:this.program(3,a,s),data:a}),null!=i&&(l+=i),l+'\n    </button>\n    <a href="#" class="js-modal-close" id="create-custom-measure-cancel">Cancel</a>\n  </div>\n</form>\n'},useData:!0,useDepths:!0})},2270:function(e,t,n){function a(e){return e&&(e.__esModule?e.default:e)}var s=n(5);e.exports=(s.default||s).template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,s,i){var o=this.escapeExpression;return'<header class="page-header">\n  <h1 class="page-title">'+o(a(n(1)).call(e,"custom_measures.page",{name:"t",hash:{},data:i}))+'</h1>\n  <div class="page-actions">\n    <div class="button-group">\n      <button id="custom-measures-create">'+o(a(n(1)).call(e,"create",{name:"t",hash:{},data:i}))+'</button>\n    </div>\n  </div>\n  <p class="page-description">'+o(a(n(1)).call(e,"custom_measures.page.description",{name:"t",hash:{},data:i}))+"</p>\n</header>\n"},useData:!0})},2271:function(e,t,n){var a=n(5);e.exports=(a.default||a).template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,a){return'<div class="page page-limited">\n  <div id="custom-measures-header"></div>\n  <div id="custom-measures-list"></div>\n  <div id="custom-measures-list-footer"></div>\n</div>\n'},useData:!0})},2272:function(e,t,n){var a=n(5);e.exports=(a.default||a).template({1:function(e,t,n,a){return'    <a id="custom-measures-fetch-more" class="spacer-left" href="#">show more</a>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,a){var s,i,o=t.helperMissing,r=this.escapeExpression,l='<footer class="spacer-top note text-center">\n  '+r((i=null!=(i=t.count||(null!=e?e.count:e))?i:o,"function"==typeof i?i.call(e,{name:"count",hash:{},data:a}):i))+"/"+r((i=null!=(i=t.total||(null!=e?e.total:e))?i:o,"function"==typeof i?i.call(e,{name:"total",hash:{},data:a}):i))+" shown\n";return s=t.if.call(e,null!=e?e.more:e,{name:"if",hash:{},fn:this.program(1,a),inverse:this.noop,data:a}),null!=s&&(l+=s),l+"</footer>\n"},useData:!0})},2273:function(e,t,n){function a(e){return e&&(e.__esModule?e.default:e)}var s=n(5);e.exports=(s.default||s).template({1:function(e,t,s,i){var o=this.escapeExpression;return'      <span class="js-custom-measure-pending badge badge-warning spacer-left"\n            title="'+o(a(n(1)).call(e,"custom_measures.pending_tooltip",{name:"t",hash:{},data:i}))+'"\n            data-toggle="tooltip" data-placement="bottom">'+o(a(n(1)).call(e,"custom_measures.pending",{name:"t",hash:{},data:i}))+"</span>\n"},3:function(e,t,s,i){return'    Updated on <span class="js-custom-measure-created-at">'+(0,this.escapeExpression)(a(n(328)).call(e,null!=e?e.updatedAt:e,{name:"d",hash:{},data:i}))+"</span>\n"},5:function(e,t,s,i){return'    Created on <span class="js-custom-measure-created-at">'+(0,this.escapeExpression)(a(n(328)).call(e,null!=e?e.createdAt:e,{name:"d",hash:{},data:i}))+"</span>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,s,i){var o,r=this.lambda,l=this.escapeExpression,u='<td class="nowrap">\n  <div>\n    <span class="js-custom-measure-metric-name">'+l(r(null!=(o=null!=e?e.metric:e)?o.name:o,e))+"</span>\n";return o=t.if.call(e,null!=e?e.pending:e,{name:"if",hash:{},fn:this.program(1,i),inverse:this.noop,data:i}),null!=o&&(u+=o),u+='  </div>\n  <span class="js-custom-measure-domain note">'+l(r(null!=(o=null!=e?e.metric:e)?o.domain:o,e))+'</span>\n</td>\n\n<td class="nowrap">\n  <strong class="js-custom-measure-value">'+l(a(n(98)).call(e,null!=e?e.value:e,null!=(o=null!=e?e.metric:e)?o.type:o,{name:"formatMeasure",hash:{},data:i}))+'</strong>\n</td>\n\n<td class="">\n  <span class="js-custom-measure-description">'+l(r(null!=e?e.description:e,e))+'</span>\n</td>\n\n<td class="">\n',o=t.if.call(e,null!=e?e.updatedAt:e,{name:"if",hash:{},fn:this.program(3,i),inverse:this.program(5,i),data:i}),null!=o&&(u+=o),u+'  by <span class="js-custom-measure-user">'+l(r(null!=(o=null!=e?e.user:e)?o.name:o,e))+'</span>\n</td>\n\n<td class="thin nowrap">\n  <a class="js-custom-measure-update icon-edit" title="Update" data-toggle="tooltip" href="#"></a>\n  <a class="js-custom-measure-delete icon-delete" title="Delete" data-toggle="tooltip" href="#"></a>\n</td>\n'},useData:!0})},2274:function(e,t,n){var a=n(5);e.exports=(a.default||a).template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,a){return'<table class="data zebra">\n  <thead>\n  <tr>\n    <th>Metric</th>\n    <th>Value</th>\n    <th>Description</th>\n    <th>Date</th>\n    <th>&nbsp;</th>\n  </tr>\n  </thead>\n  <tbody></tbody>\n</table>\n'},useData:!0})}});
//# sourceMappingURL=10.120e1585.chunk.js.map